<div class="container">
  <h1>Mini one-page prodavnica</h1>

  <div class="toggle-source">
    <label>
      <input type="checkbox" [(ngModel)]="useBackend" (change)="toggleDataSource()" />
      Koristi Java Spring backend
    </label>
  </div>

  <div class="controls">
    <input type="text" placeholder="Pretraži proizvode..." [(ngModel)]="filterText" />

    <label>Sortiraj po:
      <select [(ngModel)]="sortBy">
        <option value="name">Naziv</option>
        <option value="price">Cena</option>
      </select>
    </label>

    <label>Smer:
      <select [(ngModel)]="sortDirection">
        <option value="asc">Rastuće</option>
        <option value="desc">Opadajuće</option>
      </select>
    </label>
  </div>

  <div class="main-layout">
    <div class="products">
      <h2>Proizvodi</h2>

      <div *ngIf="!hasProducts()" class="no-products">Nema proizvoda</div>

      <div *ngIf="hasProducts() && filteredProducts.length === 0" class="no-products">
        Nema rezultata za pretragu
      </div>

      <div class="product-grid" *ngIf="filteredProducts.length > 0">
        <div *ngFor="let p of filteredProducts" class="product-card">
          <strong>{{ p.name }}</strong>
          <div class="product-desc">{{ p.description }}</div>
          <div class="product-price">
            {{ p.price | currency : "RSD" : "symbol" : "1.2-2" }}
          </div>
          <div *ngIf="availableStock(p) > 0" class="stock">
            Na stanju: {{ availableStock(p) }}
          </div>
          <div *ngIf="availableStock(p) === 0" class="stock">Nema na stanju</div>
          <div class="btn-add">
            <button (click)="addToCart(p)" [disabled]="availableStock(p) === 0">
              Dodaj u korpu
            </button>
          </div>
        </div>
      </div>
    </div>

    <app-cart
      [products]="products"
      [cart]="cart"
      [showRaw]="showRaw"
      [isCartEmpty]="isCartEmpty()"
      [checkoutMessage]="checkoutMessage"
      (checkout)="onCheckout()"
      (resetCart)="onResetCart()"
      (changeQty)="onChangeQty($event)"
      (removeFromCart)="onRemoveFromCart($event)"
      (toggleRaw)="onToggleRaw()"
    ></app-cart>
  </div>
</div>
